## 中断

中断是计算机系统中一种重要的机制，用于处理异步事件或紧急任务。当某个事件发生时（如硬件设备请求、程序错误等），处理器会暂停当前的任务，转而去处理该事件，处理完成后再恢复原来的任务。中断机制使得计算机能够高效地响应外部事件，同时保证系统的实时性和可靠性。

## 中断分类
### 硬件中断：
由硬件设备触发，例如键盘输入、鼠标点击、磁盘 I/O 完成等。硬件中断又可以分为：
- 可屏蔽中断：可以通过设置中断屏蔽位来忽略（如键盘输入）。
- 不可屏蔽中断（NMI）：必须立即处理，通常用于严重错误（如内存校验错误）。

### 软件中断：
由程序主动触发，通常用于系统调用或异常处理。例如，程序通过 int 指令触发中断，请求操作系统提供服务。

### 异常：
由 CPU 执行指令时检测到的错误或特殊情况触发，例如除零错误、页面故障、非法指令等。异常通常分为：
- 故障（Fault）：可修复的错误，修复后可以重新执行指令。
- 陷阱（Trap）：用于调试或系统调用，执行后继续下一条指令。
- 终止（Abort）：严重错误，无法修复，通常导致程序终止。

## 中断流程
中断的处理流程通常分为以下几个步骤：
### 中断触发：
硬件设备或软件触发中断，向 CPU 发送中断信号。

### 保存现场：
CPU 暂停当前任务的执行，保存当前的上下文（如程序计数器、寄存器状态等），以便中断处理完成后恢复。

### 识别中断源：
CPU 通过中断向量表（Interrupt Vector Table）或中断描述符表（IDT）确定中断的类型和来源。

### 执行中断处理程序：
CPU 跳转到对应的中断处理程序（Interrupt Service Routine, ISR）执行。
如果是硬件中断，操作系统可能会调用设备驱动程序来处理。
如果是软件中断（如系统调用），操作系统会根据中断号执行相应的服务。

### 恢复现场：
中断处理完成后，CPU 恢复之前保存的上下文，继续执行被中断的任务。

### 返回原任务：
通过特定的指令（如 iret）返回到被中断的程序，继续执行。

## 中断控制芯片配置

## 设置中断向量表

## 时钟中断