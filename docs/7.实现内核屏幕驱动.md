## 8086 内存布局图
|起始地址	|大小	|用途|
|-----|------|------|
|0x00000	|1KB	|BIOS的中断向量表|
|0x00400	|256B	|BIOS数据区|
|0x00500	|29KB+768B	|可用区域|
|0x07C00	|512B	|引导扇区数据，被BIOS加载到此处|
|0x07E00	|607KB+512B	|可用区域|
|0x9FC00	|1KB	|扩展BIOS数据区|
|0xA0000	|64KB	|彩色显示适配器缓存|
|0xB0000	|32KB	|黑白显示适配器缓存|
|0xB8000	|32KB	|文本模式显示适配器缓存|
|0xC0000	|32KB	|显示适配器BIOS|
|0xC8000	|160KB	|映射硬件适配器ROM或内存映射式的IO|
|0xF0000	|64KB	|BIOS程序，入口地址在0xFFFF0|

文本模式显示适配器缓存(32K)：0xB8000 ~ 0xBFFFF

## 操作光标位置
在操作系统中，屏幕驱动的光标操作通常是通过与显示硬件的交互来实现的。在文本模式下，光标的位置和显示通常由 VGA（Video Graphics Array） 或 VGA 兼容的硬件 控制。VGA 提供了两个 I/O 端口来管理光标：   
0x3D4：索引端口，用于选择要操作的寄存器。  
0x3D5：数据端口，用于读写寄存器的值。
  
寄存器（0x0E）：光标位置的高字节。    
寄存器（0x0F）：光标位置的低字节。  
光标的位置是一个 16 位的值，表示光标在屏幕上的偏移量（从屏幕左上角开始计算）。

qemu 屏幕的大小 80*25*2 = 4000 , 文本模式显示适配器缓存(32K)  
寄存器（0x0C）：显示内存起始位置高位。    
寄存器（0x0D）：显示内存起始位置低位。

## 字符属性字节的格式
位 7 | 位 6 | 位 5 | 位 4 | 位 3 | 位 2 | 位 1 
----- | ----- | ----- | ----- | ----- | ----- | ----- 
闪烁 | 背景色 (R) | 背景色 (G) | 背景色 (B) | 前景色 (R) | 前景色 (G) | 前景色 (B)

## 可变参数的原理
```cpp
void args(int start, ...) {
    int *s = &start;
    int n1 = *(s+1);
    int n2 = *(s+2);
    int n3 = *(s+3);
}

void kernel_init(){
    console_init();
    for (int i = 0; i < 40; i++) {
        args(10, 20, 30, 40);
    }
}
```
看懂上面代码再结合汇编就能理解 C 语言可变参数的原理了。
```cpp
typedef char* va_list;
#define va_start(arg_p, arg_start) (arg_p = (va_list)&arg_start + sizeof(char *))
#define va_arg(arg_p, type) (*(type *)((arg_p += sizeof(type)) - sizeof(type)))
#define va_end(arg_p) (arg_p = (va_list)0)
```

